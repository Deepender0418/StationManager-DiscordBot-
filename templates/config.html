<!DOCTYPE html>
<html>
<head>
    <title>Server Configuration - {{ guild_name }}</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        h1 { color: #333; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        select { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc; }
        button { background-color: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #45a049; }
        .timezone-info { margin-top: 30px; padding: 15px; background: #f5f5f5; border-radius: 4px; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>Server Configuration: {{ guild_name }}</h1>
    <p>Guild ID: {{ guild_id }}</p>
    
    <form method="POST">
        <div class="form-group">
            <label for="welcome_channel">Welcome Channel:</label>
            <select id="welcome_channel" name="welcome_channel">
                <option value="">-- Select Channel --</option>
                {% for channel in channels %}
                <option value="{{ channel.id }}" {% if config.welcome_channel_id == channel.id %}selected{% endif %}>
                    {{ channel.name }}
                </option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label for="log_channel">Log Channel:</label>
            <select id="log_channel" name="log_channel">
                <option value="">-- Select Channel --</option>
                {% for channel in channels %}
                <option value="{{ channel.id }}" {% if config.log_channel_id == channel.id %}selected{% endif %}>
                    {{ channel.name }}
                </option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label for="announcement_channel">Announcement Channel:</label>
            <select id="announcement_channel" name="announcement_channel">
                <option value="">-- Select Channel --</option>
                {% for channel in channels %}
                <option value="{{ channel.id }}" {% if config.announcement_channel_id == channel.id %}selected{% endif %}>
                    {{ channel.name }}
                </option>
                {% endfor %}
            </select>
        </div>
        
        <button type="submit">Save Configuration</button>
    </form>

    <div class="mt-3">
        <a href="/birthdays/{{ guild_id }}" class="btn btn-success">
            <i class="bi bi-balloon-heart"></i> Manage Birthdays
        </a>
    </div>
    
    <div class="timezone-info">
        <h2>Time Zone Information</h2>
        <p>Birthday announcements will occur at <strong>midnight IST (UTC+5:30)</strong></p>
        <p>Current IST time: <span id="current-time">Loading...</span></p>
        <p>Next birthday check: <span id="next-check">Loading...</span></p>
    </div>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <p class="{{ category }}">{{ message }}</p>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div class="card mt-4">
    <div class="card-header bg-info text-white">
        <i class="bi bi-megaphone"></i> Announcement Command
    </div>
    <div class="card-body">
        <p>To send an announcement as the bot, use this command in Discord:</p>
        
        <div class="alert alert-secondary">
            <code>/announce [your message]</code>
        </div>
        
        <div class="mt-3">
            <h5>Features:</h5>
            <ul>
                <li>Messages appear in the configured announcement channel</li>
                <li>Professional embedded format</li>
                <li>Admin-only access</li>
                <li>Includes attribution to admin who sent it</li>
            </ul>
        </div>
        
        <div class="mt-3 p-3 bg-light border rounded">
            <h5>Example:</h5>
            <p><code>/announce Join our tournament this Saturday at 8PM! Prizes for top players!</code></p>
            <div class="d-flex align-items-center">
                <div class="me-2">
                    <img src="https://cdn.discordapp.com/embed/avatars/0.png" width="40" height="40" class="rounded-circle">
                </div>
                <div class="flex-grow-1">
                    <div class="card border-primary" style="max-width: 500px;">
                        <div class="card-header bg-primary text-white p-2">
                            <strong>ðŸ“¢ Server Announcement</strong>
                        </div>
                        <div class="card-body p-2">
                            Join our tournament this Saturday at 8PM! Prizes for top players!
                        </div>
                        <div class="card-footer text-muted p-1 px-2" style="font-size: 0.8em;">
                            Announced by AdminName
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    
    <script>
        function updateTimes() {
            const now = new Date();
            const istOffset = 5.5 * 60 * 60 * 1000;
            const istTime = new Date(now.getTime() + istOffset);
            
            document.getElementById('current-time').textContent = 
                istTime.toISOString().replace('T', ' ').substring(0, 19) + " IST";
            
            const nextCheck = new Date(istTime);
            nextCheck.setDate(nextCheck.getDate() + 1);
            nextCheck.setHours(0, 0, 0, 0);
            
            document.getElementById('next-check').textContent = 
                nextCheck.toISOString().replace('T', ' ').substring(0, 19) + " IST";
        }
        
        updateTimes();
        setInterval(updateTimes, 60000);
    </script>
</body>
</html>